<?xml version="1.0" encoding="UTF-8" ?>
<Module>
  <ModulePrefs title="Fetch JSON Example"/>
  <UserPref name="myrefresh" display_name="Refresh Interval" default_value="300">
  <UserPref name="myapi" display_name="API Key" default_value=""/>
  <UserPref name="mygroup" display_name="Group Name" default_value="uVBpt_V2xSY"/>
  <UserPref name="mywidth" display_name="Width" default_value="500"/>
  <UserPref name="myheight" display_name="Height" default_value="500"/>
  </UserPref>
  <Content type="html">
  <![CDATA[
    <div id="content_div"></div>
    <script type="text/javascript">
    
    setInterval(makeJSONRequest, 15000);
    var prefs = new gadgets.Prefs();
    var lastUrl = "";
    
    function makeJSONRequest() {    
      var params = {};
      alert("request");
      params[gadgets.io.RequestParameters.CONTENT_TYPE] = gadgets.io.ContentType.JSON;
      var url = "http://api.reveldigital.com/media?api_key="+prefs.getString("myapi")+"&format=json&";
      gadgets.io.makeRequest(url, response, params);
    };
    
    function response(obj) { 
      alert("response");
      var jsonData = obj.data;
      var html="";
      var jsonObj = JSON.parse(JSON.stringify(jsonData));
      var srcURL="no url found";
      var newestValue = 0;


     };
     
     gadgets.util.registerOnLoadHandler(makeJSONRequest);
     </script>
  ]]>
  </Content>
</Module>


